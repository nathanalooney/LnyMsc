var player={song:{prev:null,curr:null,next:null},currentGenre:"all",playlist:{all:[],excite:[],bounce:[],heavy:[],mellow:[],daze:[],best:[]},initialized:{all:true,excite:false,bounce:false,heavy:false,mellow:false,daze:false,best:false},page:{all:0,excite:0,bounce:0,heavy:0,mellow:0,daze:0,best:0}};SC.initialize({client_id:"328ae5752ec4b2ff5d3c89f27a34fa14"});var loadInitial=function(){$("#front").css("color","#ff4400");var e=player.playlist[player.currentGenre];var t="#"+player.currentGenre+"Posts";$.get("/api/posts/"+player.currentGenre,{page:0,limit:6,offset:0},function(n){for(i=0;i<n.length;i++){$(t).append(n[i].embed)}var r=$(t).children("iframe");for(var i=0;i<r.length;i++){e[i]=SC.Widget(r[i])}player.song.curr=e[0];for(var i=0;i<e.length-1;i++){if(i==e.length-2){setTrigger(e[i])}bindWidgets(e[i-1],e[i],e[i+1])}})};var loadPosts=function(){player.page[player.currentGenre]+=1;var e=player.playlist[player.currentGenre];var t="#"+player.currentGenre+"Posts";$.get("api/posts/"+player.currentGenre,{page:player.page[player.currentGenre],limit:3,offset:6},function(n){for(i=0;i<n.length;i++){$(t).append(n[i].embed);e.push(SC.Widget($(t).children("iframe").last()[0]))}var r=e.slice(-5);r[0].unbind(SC.Widget.Events.FINISH);r[0].unbind(SC.Widget.Events.PAUSE);setTrigger(r[3]);for(i=1;i<r.length-1;i++){bindWidgets(r[i-1],r[i],r[i+1])}})};var setTrigger=function(e){e.bind(SC.Widget.Events.PAUSE,function(){loadPosts()});e.bind(SC.Widget.Events.FINISH,function(){loadPosts()})};var bindWidgets=function(e,t,n){t.bind(SC.Widget.Events.PLAY,function(){$("#playPause").html('<span class="glyphicon glyphicon-pause">');player.song.prev=e;player.song.curr=t;player.song.next=n;player.song.curr.getCurrentSound(function(e){var t=e.title;$("#songTitle").html(t.slice(0,30))})});t.bind(SC.Widget.Events.PAUSE,function(){player.song.curr.isPaused(function(e){if(e){$("#playPause").html('<span class="glyphicon glyphicon-play">')}})});t.bind(SC.Widget.Events.FINISH,function(){n.play()})};var hidePosts=function(){$("#centeredContent").children().each(function(){if($(this).is(":visible")){$(this).hide(400,"swing")}})};var changeFontColor=function(){$("td").each(function(){$(this).css("color","#333333")})};var scrollLoad=function(){if($(window).scrollTop()+$(window).height()>$(document).height()-300){$(window).off("scroll");loadPosts();setTimeout(function(){$(window).on("scroll",scrollLoad)},500)}};$("#excite").click(function(){player.currentGenre="excite";hidePosts();changeFontColor();$("#excite").css("color","#ff4400");if(player.initialized.excite==false){$("#excitePosts").show(400,"swing",function(){loadInitial();player.initialized.excite=true})}else{$("#excitePosts").show(400,"swing")}});$("#bounce").click(function(){player.currentGenre="bounce";hidePosts();changeFontColor();$("#bounce").css("color","#ff4400");if(player.initialized.bounce==false){$("#bouncePosts").show(400,"swing",function(){loadInitial();player.initialized.bounce=true})}else{$("#bouncePosts").show(400,"swing")}});$("#heavy").click(function(){player.currentGenre="heavy";hidePosts();changeFontColor();$("#heavy").css("color","#ff4400");if(player.initialized.heavy==false){$("#heavyPosts").show(400,"swing",function(){loadInitial();player.initialized.heavy=true})}else{$("#heavyPosts").show(400,"swing")}});$("#mellow").click(function(){player.currentGenre="mellow";hidePosts();changeFontColor();$("#mellow").css("color","#ff4400");if(player.initialized.mellow==false){$("#mellowPosts").show(400,"swing",function(){loadInitial();player.initialized.mellow=true})}else{$("#mellowPosts").show(400,"swing")}});$("#daze").click(function(){player.currentGenre="daze";hidePosts();changeFontColor();$("#daze").css("color","#ff4400");if(player.initialized.daze==false){hidePosts();$("#dazePosts").show(400,"swing",function(){loadInitial();player.initialized.daze=true})}else{$("#dazePosts").show(400,"swing")}});$("#best").click(function(){player.currentGenre="best";hidePosts();changeFontColor();$("#best").css("color","#ff4400");if(player.initialized.best==false){hidePosts();$("#bestPosts").show(400,"swing",function(){player.currentGenre="best";loadInitial();player.initialized.best=true})}else{$("#bestPosts").show(400,"swing")}});$("#all").click(function(){player.currentGenre="all";hidePosts();changeFontColor();$("#all").css("color","#ff4400");if(player.initialized.all==false){$("#allPosts").show(400,"swing",function(){loadInitial();player.initialized.all=true})}else{$("#allPosts").show(400,"swing")}});$("#playPrev").click(function(e){e.preventDefault();player.song.prev.play();player.song.prev.seekTo(0)});$("#playPause").click(function(e){e.preventDefault();var t=player.song.curr.isPaused(function(e){if(e){player.song.curr.play();$("#playPause").html('<span class="glyphicon glyphicon-play">')}else{player.song.curr.pause();$("#playPause").html('<span class="glyphicon glyphicon-pause">')}})});$("#playNext").click(function(e){e.preventDefault();player.song.next.play();player.song.next.seekTo(0)});$(document).ready(function(){loadInitial(player.currentGenre);$("#all").css("color","#ff4400");setTimeout(function(){$(window).on("scroll",scrollLoad)},1e3)})